<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¿«é€’æŸ¥è¯¢ - Declarative API Demo</title>
  <link rel="stylesheet" href="../styles.css">
  <style>
    .tracking-result{display:none;margin-top:1.5rem;padding:1.5rem;background:var(--bg);border-radius:12px}
    .tracking-result.show{display:block}
    .tracking-timeline{position:relative;padding-left:2rem}
    .tracking-timeline::before{content:'';position:absolute;left:0.5rem;top:0;bottom:0;width:2px;background:var(--border)}
    .tracking-item{position:relative;padding-bottom:1.5rem}
    .tracking-item::before{content:'';position:absolute;left:-1.75rem;top:0.25rem;width:12px;height:12px;border-radius:50%;background:var(--secondary);border:2px solid #fff}
    .tracking-item:first-child::before{background:var(--primary)}
    .tracking-item-time{font-size:0.85rem;color:var(--text-secondary)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ“¦ å¿«é€’æŸ¥è¯¢ç³»ç»Ÿ</h1>
      <p><span class="badge badge-declarative">Declarative API</span> HTML å±æ€§å£°æ˜å¼å®ç°</p>
    </header>
    <div class="card">
      <h2>ğŸ” æŸ¥è¯¢å¿«é€’</h2>
      <p style="margin-bottom:1rem;color:var(--text-secondary)">è¿™ä¸ªè¡¨å•ä½¿ç”¨ HTML å±æ€§è‡ªåŠ¨æ³¨å†Œä¸º WebMCP å·¥å…·</p>
      <form id="tracking-form" toolname="track_package" tooldescription="æŸ¥è¯¢å¿«é€’ç‰©æµä¿¡æ¯" onsubmit="handleTrackingSubmit(event)">
        <div class="form-group">
          <label>å¿«é€’å…¬å¸</label>
          <select name="carrier" required toolparamtitle="å¿«é€’å…¬å¸" toolparamdescription="SF=é¡ºä¸°,YTO=åœ†é€š,ZTO=ä¸­é€š,JD=äº¬ä¸œ">
            <option value="">è¯·é€‰æ‹©</option>
            <option value="SF">é¡ºä¸°é€Ÿè¿</option>
            <option value="YTO">åœ†é€šé€Ÿé€’</option>
            <option value="ZTO">ä¸­é€šå¿«é€’</option>
            <option value="JD">äº¬ä¸œç‰©æµ</option>
          </select>
        </div>
        <div class="form-group">
          <label>è¿å•å·</label>
          <input type="text" name="tracking_number" required placeholder="è¯·è¾“å…¥è¿å•å·" toolparamtitle="è¿å•å·" toolparamdescription="å¿«é€’è¿å•å·">
        </div>
        <button type="submit" class="btn btn-primary">ğŸ” æŸ¥è¯¢ç‰©æµ</button>
      </form>
      <div id="tracking-result" class="tracking-result">
        <h3 style="margin-bottom:1rem">ğŸ“‹ ç‰©æµè½¨è¿¹</h3>
        <div class="status" id="tracking-status">è¿è¾“ä¸­</div>
        <div class="tracking-timeline" id="tracking-timeline" style="margin-top:1rem"></div>
      </div>
    </div>
    <div class="card">
      <h2>ğŸ’» HTML ä»£ç ç¤ºä¾‹</h2>
      <pre class="result-box">&lt;form toolname="track_package"
      tooldescription="æŸ¥è¯¢å¿«é€’"&gt;
  &lt;select name="carrier" 
          toolparamtitle="å¿«é€’å…¬å¸"&gt;
    &lt;option value="SF"&gt;é¡ºä¸°&lt;/option&gt;
  &lt;/select&gt;
  &lt;input name="tracking_number"
         toolparamtitle="è¿å•å·"&gt;
&lt;/form&gt;</pre>
    </div>
    <div class="card">
      <h2>ğŸ“ æ‰§è¡Œæ—¥å¿—</h2>
      <div id="log-container" class="result-box" style="min-height:100px;max-height:300px;overflow-y:auto">ç­‰å¾…æ“ä½œ...</div>
    </div>
    <a href="../" class="btn btn-outline" style="margin-top:1rem">â† è¿”å›é¦–é¡µ</a>
  </div>
  <div class="tool-indicator"><div class="tool-indicator-dot"></div><span>Declarative å·¥å…·å·²æ³¨å†Œ</span></div>
  <script>
    function log(msg) { document.getElementById('log-container').textContent = `[${new Date().toLocaleTimeString()}] ${msg}\n\n` + document.getElementById('log-container').textContent; }
    function getMockData(carrier, num) {
      const names = { SF: 'é¡ºä¸°', YTO: 'åœ†é€š', ZTO: 'ä¸­é€š', JD: 'äº¬ä¸œ' };
      return { carrier: names[carrier] || carrier, trackingNumber: num, status: 'è¿è¾“ä¸­', timeline: [
        { time: '2026-02-11 14:30', desc: 'å¿«ä»¶å·²åˆ°è¾¾ã€åŒ—äº¬è½¬è¿ä¸­å¿ƒã€‘' },
        { time: '2026-02-11 08:15', desc: 'å¿«ä»¶å·²ä»ã€ä¸Šæµ·è½¬è¿ä¸­å¿ƒã€‘å‘å‡º' },
        { time: '2026-02-10 22:40', desc: 'å¿«ä»¶å·²åˆ°è¾¾ã€ä¸Šæµ·è½¬è¿ä¸­å¿ƒã€‘' },
        { time: '2026-02-10 16:05', desc: 'å¿«é€’å‘˜å·²æ½æ”¶' },
      ]};
    }
    function handleTrackingSubmit(e) {
      e.preventDefault();
      const carrier = e.target.carrier.value, num = e.target.tracking_number.value;
      log(`ğŸ” æŸ¥è¯¢: ${carrier} - ${num}`);
      if (e.agentInvoked) { log('ğŸ¤– AI ä»£ç†è§¦å‘'); e.respondWith(Promise.resolve(JSON.stringify(getMockData(carrier, num)))); }
      const data = getMockData(carrier, num);
      document.getElementById('tracking-status').textContent = data.status;
      document.getElementById('tracking-timeline').innerHTML = data.timeline.map(t => `<div class="tracking-item"><div class="tracking-item-time">${t.time}</div><div>${t.desc}</div></div>`).join('');
      document.getElementById('tracking-result').classList.add('show');
      log(`âœ… æŸ¥è¯¢æˆåŠŸ: ${data.carrier} ${data.trackingNumber}`);
    }
    window.addEventListener('toolactivated', ({ toolName }) => log(`ğŸ¤– AI ä½¿ç”¨å·¥å…·: ${toolName}`));
    document.addEventListener('DOMContentLoaded', () => { log('âœ… Declarative å·¥å…·å·²è‡ªåŠ¨æ³¨å†Œ'); });
  </script>
</body>
</html>
